<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Enhanced Search Component</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Simple search component to test dropdown functionality
        const TestSearchComponent = () => {
            const [searchType, setSearchType] = useState('unified');
            const [searchQuery, setSearchQuery] = useState('');
            const [isSearching, setIsSearching] = useState(false);
            
            return (
                <div className="max-w-4xl mx-auto p-6">
                    <div className="bg-white rounded-lg shadow p-6">
                        <h2 className="text-2xl font-bold mb-6">üîç Enhanced Search Test</h2>
                        
                        {/* Search Type Dropdown */}
                        <div className="mb-4">
                            <label className="block text-sm font-medium text-gray-700 mb-2">
                                Search In:
                            </label>
                            <select
                                value={searchType}
                                onChange={(e) => setSearchType(e.target.value)}
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white"
                            >
                                <option value="unified">üåê Search Everything (Unified)</option>
                                <option value="homeowners">üë§ Homeowners (by name, ID, email, phone)</option>
                                <option value="bid_cards">üìã Bid Cards (by homeowner name)</option>
                                <option value="contractors">üë∑ Contractors (by name, company, location)</option>
                            </select>
                        </div>

                        {/* Search Input */}
                        <div className="mb-4">
                            <input
                                type="text"
                                placeholder={
                                    searchType === "unified"
                                        ? "Search across all bid cards, homeowners, and contractors..."
                                        : searchType === "bid_cards"
                                        ? "Search bid cards by homeowner name..."
                                        : searchType === "homeowners"
                                        ? "Search homeowners by name, ID, email, or phone..."
                                        : "Search contractors by name, company, location, or specialty..."
                                }
                                value={searchQuery}
                                onChange={(e) => setSearchQuery(e.target.value)}
                                className="w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            />
                        </div>
                        
                        {/* Status Display */}
                        <div className="bg-blue-50 rounded-lg p-4">
                            <h3 className="font-medium text-blue-900 mb-2">Current Selection:</h3>
                            <p className="text-blue-700">
                                <strong>Type:</strong> {searchType} <br/>
                                <strong>Query:</strong> {searchQuery || 'None'} <br/>
                                <strong>API Endpoint:</strong> /api/admin/search/{searchType === 'unified' ? 'unified' : searchType === 'bid_cards' ? 'bid-cards/by-homeowner' : searchType}
                            </p>
                        </div>
                        
                        {/* Test API Button */}
                        <button
                            onClick={async () => {
                                if (!searchQuery.trim()) {
                                    alert('Please enter a search query');
                                    return;
                                }
                                
                                setIsSearching(true);
                                try {
                                    let endpoint = '/api/admin/search/unified';
                                    let params = new URLSearchParams();
                                    
                                    switch (searchType) {
                                        case 'unified':
                                            params.append('query', searchQuery);
                                            break;
                                        case 'bid_cards':
                                            endpoint = '/api/admin/search/bid-cards/by-homeowner';
                                            params.append('homeowner_name', searchQuery);
                                            break;
                                        case 'homeowners':
                                            endpoint = '/api/admin/search/homeowners';
                                            params.append('search_term', searchQuery);
                                            break;
                                        case 'contractors':
                                            endpoint = '/api/admin/search/contractors';
                                            params.append('search_term', searchQuery);
                                            break;
                                    }
                                    
                                    const response = await fetch(`http://localhost:8008${endpoint}?${params}`);
                                    const data = await response.json();
                                    alert(`Success! Found: ${JSON.stringify(data, null, 2)}`);
                                } catch (error) {
                                    alert(`Error: ${error.message}`);
                                } finally {
                                    setIsSearching(false);
                                }
                            }}
                            disabled={isSearching}
                            className="mt-4 w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400"
                        >
                            {isSearching ? 'Testing...' : 'Test Search API'}
                        </button>
                    </div>
                </div>
            );
        };
        
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<TestSearchComponent />);
    </script>
</body>
</html>